<!DOCTYPE html>
<html>
  <head>
    <title>Epicby</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<link rel="stylesheet" href="/css/styles.css">
	<link rel='stylesheet' href='/css/almost-flat-buttons.css'>
    <link rel='stylesheet' href='//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
	<script src="//cdn.jsdelivr.net/underscorejs/1.4.4/underscore-min.js" type="text/javascript"></script>
	<script src="//cdn.jsdelivr.net/backbonejs/0.9.10/backbone-min.js" type="text/javascript"></script>

</head>
<body>
	<div id="fb-root"></div>
	<script src='js/config.js'></script>
	<script src="http://connect.facebook.net/en_US/all.js"></script>
	<script src='js/fbLike.js'></script>
	
	<body>
	   	<div id="headerbar" class="navbar navbar-fixed-top"></div>
		<div class="my-page-header"></div>
		<div id="container" class="container"></div>
</body>

<!-- Template for a message that can be changed according to what happens-->
<script type="text/template" id="ventMsg">
<% if (msg != "") { %>
<div class="alert"><%= msg %></div>
<% } %>
</script>
<!-- TEMPLATES!!!! -->

<!-- The Header -->
<script type="text/template" id="header_bar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">Piazzo</a>
      <div class="navbar-content">
        <ul class="nav  pull-right">
        	<li>
			<% if (place === 'dev') { %>
        		<div class="fb-like liked" data-href="http://localhost:5000" data-send="false" data-layout="button_count" data-width="120" data-show-faces="false" data-font="arial"></div><%} else {%>
				<div class="fb-like liked" data-href="http://piazzo.co" data-send="false" data-layout="button_count" data-width="120" data-show-faces="false" data-font="arial"></div>
<% } %>
    		</li>
        	<li>
        		<a href="#options">Options</a>
    		</li>
			  <li>
				<a href="/logout">Logout</a>
			  </li>
        </ul>
      </div>
    </div>
  </div>
</script>	
<!-- "Meta" Template that has placeholders for button "UPfoButtonView" and list of friends who are users "userView" and those who are not "nonUserView"-->
<script type="text/template" id="active_page">
	<div id="upfoButtonView"><!--UpfoButtonView--></div>
	<div id="messages" ><!-- messages --></div>
	<div class="listDiv">
		<p class="listText">Your friends that are up for something:</p>
	</div>
  	<div id="userView">
		<!-- Users who are friends --></div>
	<div id="nonUserView">
  		<p class="text-info">Invite friends that are not on Piazzo yet below or <a href="#" onclick="sendFBRequest();">click here to invite more people at the same time.</a></p>
  		<table class="table table-condensed" id="nonuser"><tbody></tbody></table>
	</div>
</script>



<!-- Phone number and city input for Options page -->
<script type="text/template" id="page_options_t">
	<form id="optionsform" class="form-horizontal">
		<fieldset>
		<legend>Options</fieldset>
		<div class="row">
			<div class="large-4 columns">
				<label>Phone:</label>
				<input id="user-phone" type="text" value="<%= phoneNumber %>">
			</div>
		</div>
		<div class="row">
			<div class="large-4 columns">
				<label>City:</label>
				<input id="user-city" type="text" value="<%= city %>">
			</div>
		</div>
		<div class="row">
			<div class="large-4 columns">
			<button type="submit" class="button primary-dark small" id="save">Save</button> or
			<button class="button primary-dark small" id="fetchGPS">Fetch GPS location</button>
			</div>
		</div>
		
		
		</fieldset>
		<!--
		<div class="control-group">
			<label class="control-label" for="user-phone">Phone:</label>
			<div class="controls"><input id="user-phone" type="text" value="<%= phoneNumber %>" class="input-medium"></div>
		</div>
		<div class="control-group">
			<label class="control-label" for="user-city">City:</label>
			<div class="controls"><input id="user-city" type="text" value="<%= city %>" class="input-medium"></div>
		</div>
		<div class="control-group">
			<button type="submit" class="button primary-dark small" id="save">Save</button> or
			<button class="button primary-dark small" id="fetchGPS">Fetch GPS location</button>
		</div>-->
	</form>
</script>




<!-- Button and message -->
<script type="text/template" id="upfo_button">
	<% if (upfo === false) { %>
		<p id="firstText" class="text-info">Tell your friends that you're up for something:</p>
		<!-- <form class="form-vertical" id="active">-->
		<input id="user-message" type="text" placeholder="Your message" class="input-medium input-block-level">
		<p id="cityText"><i class="icon-map-marker"></i> <%=city%>   <a href="#" id="editCity">edit</a></p>
		<div class="activeDiv">
		<button class="button primary-dark" id="active">I'm up for something!</button>
		</div>
	<!-- </form> -->
	<% } else { %>
	<p id="firstText" class="text-info">You're up for something!</p>
		<form id="msgForm">
		<table>
			<tr>
				<td><input id="user-message" type="text" class="input-medium input-block-level inputtext" placeholder="Your message" value="<%= message %>"></td>
				<td><button class="button secondary small msgset" id="msgset">Change</button></td>
			</tr>
		</table>
		</form>
		<p><i class="icon-map-marker"></i> <%=city%>    <a href="#options">change</a></p>
		<div class="activeDiv">
		<button class="button primary" onclick="publishFBStory();">Share on Facebook</button>
	<button class="button warning" id="active">Cancel</button>
	</div>
	<% } %>	
	
	
</script>


<script type="text/template" id="friend_t">
        <td class="pictd">
          <!--<img src="https://graph.facebook.com/<%= fbId?fbId:'facebook' %>/picture" class="img-rounded " width="50 "> -->
 		
        </td>
        <td class="nametd"><%= name %>
          
			<br/><small><em><%= city %><em></small>
		<% if(user) { %>
			<br/><small><%= message %></small>
		  <% } %>
		</td>
		<% if(user){ %>
			<td class="nrtd">
            <% if(typeof phoneNumber === 'undefined' || !phoneNumber) { %>
            	<a class="btn <%= upfo?'btn-success':'btn-warning' %> disabled" href="# >">Call</a> 	
            <% } else { %>
              <a class="btn <%= upfo?'btn-success':'btn-warning' %>" href="tel:<%= phoneNumber %>">Call</a> 
            <% } %>
			</td>
          <% } else { %>
			<td class="invitetd">
            <a class="butto" onclick="sendRequestToRecipients(<%= fbId %>)">Invite</a>
 			</td>
          <% } %>
</script>

<script type="text/template" id="userList">
		
	<% if(upfo) { %>
		<% if($upfoFriends.html()) { %>
	    	<table class="table table-condensed" id="upfo"><%= $upfoFriends.html() %></table>
    	<% } else { %>
			<div class="alert">None of your friends are currently up for something! Maybe you should invite more friends? You can send invites from the list below or <a href="#" onclick="sendFBRequest();">click here to invite more people at the same time.</a></div>
		<% } %>
		
    	<% if($notupfoFriends.html()) { %>
	    	<p class="text-info">Your friends that are using Piazzo but not up for something right now:</p>	  	
	    	<table class="table table-condensed" id="notupfo"><%= $notupfoFriends.html() %></table>
    	<% } %>
	<% } else { %>
			<p class="alert alert-info" id="uMessage">Set your status of to "up for something" to see the status of your Facebook friends.</p>
	
	<% } %>
</script>

<script src="js/main.js"></script>
<script src="js/views.js"></script>
<script src="js/facebook.js"></script>
<script src="js/helpers.js"></script>
<script src="js/spin.js"></script>
<script src="js/spinSettings.js"></script>

</html>